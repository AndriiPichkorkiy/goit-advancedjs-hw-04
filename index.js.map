{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/loader.js","../src/js/pixabay-api.js","../src/js/btn-show-more.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\n\nconst gallery = document.querySelector('.gallery');\n\nconst lightBox = new SimpleLightbox('.gallery .gallery-item a', {\n  captionDelay: 250, //ms\n  captionsData: 'alt',\n});\n\nfunction renderGallery(hits) {\n  const markup = hits\n    .map(item => {\n      return `\n        <li class=\"gallery-item\">\n            <a href=\"${item.largeImageURL}\">\n                <div class=\"image-wrapper\"><img src=\"${item.webformatURL}\" alt=\"${item.tags}\" /></div>\n                <ul class=\"image-description\">\n                    <li class=\"gallery-description\">\n                        <h3 class=\"description-title\">Likes</h3>\n                        <p class=\"description-value\">${item.likes}</p>\n                    </li>\n                    <li class=\"gallery-description\">\n                        <h3 class=\"description-title\">Views</h3>\n                        <p class=\"description-value\">${item.views}</p>\n                    </li>\n                    <li class=\"gallery-description\">\n                        <h3 class=\"description-title\">Comments</h3>\n                        <p class=\"description-value\">${item.comments}</p>\n                    </li>\n                    <li class=\"gallery-description\">\n                        <h3 class=\"description-title\">Downloads</h3>\n                        <p class=\"description-value\">${item.downloads}</p>\n                    </li>\n                </ul>\n            </a>\n        </li>\n        `;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  lightBox.refresh();\n}\n\nfunction resetGalelry() {\n  gallery.innerHTML = '';\n}\n\nexport { renderGallery, resetGalelry };\n","const loader = document.querySelector('.loader');\nfunction loaderShow() {\n  loader.hidden = false;\n}\n\nfunction loaderHide() {\n  loader.hidden = true;\n}\n\nexport { loaderShow, loaderHide };\n","import axios from 'axios';\n\nconst key = '27649790-7921965d78458e948654f4c92';\nconst baseURL = 'https://pixabay.com/api/';\n\nconst instance = axios.create({\n  baseURL,\n  timeout: 1000,\n  params: { key },\n});\n\nexport const paginationConfig = {\n  page: 1,\n  total: null,\n  query: '',\n  per_page: 15,\n};\n\nasync function fetchImage(query) {\n  if (query) {\n    paginationConfig.page = 1;\n  }\n\n  const searchParams = {\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    q: query || paginationConfig.query,\n    per_page: paginationConfig.per_page,\n    page: paginationConfig.page,\n  };\n\n  const response = await instance.request({\n    params: searchParams,\n  });\n\n  paginationConfig.total = response.data.total;\n  paginationConfig.page += 1;\n  if (query) paginationConfig.query = query;\n\n  if (response.status !== 200) throw new Error(response.status);\n\n  return response.data;\n\n  // return new Promise((resolve, reject) => {\n  //   const searchParams = new URLSearchParams({\n  //     key,\n  //     image_type: 'photo',\n  //     orientation: 'horizontal',\n  //     safesearch: true,\n  //     q: query || '',\n  //   });\n\n  //   fetch(baseURL + searchParams.toString(), {\n  //     method: 'GET',\n  //   })\n  //     .then(resolve)\n  //     .catch(reject);\n  // }).then(response => {\n  //   if (response.status !== 200 || !response.ok)\n  //     throw new Error('Request is failed with status: ' + response.status);\n\n  //   return response.json();\n  // });\n}\n\nexport default fetchImage;\n","const loadMore = document.querySelector('.load-more');\n\nfunction showLoadMore({ page, total, per_page }) {\n  if (total - (page - 1) * per_page > 0) {\n    btnMoreShow();\n  } else {\n    btnMoreHide();\n  }\n}\n\nfunction btnMoreShow() {\n  loadMore.hidden = false;\n}\n\nfunction btnMoreHide() {\n  loadMore.hidden = true;\n}\n\nfunction isbtnMoreHidden() {\n  return loadMore.hidden === true;\n}\n\nexport { showLoadMore, btnMoreHide, isbtnMoreHidden };","import iziToast from 'izitoast';\n\nimport { renderGallery, resetGalelry } from './js/render-functions';\nimport { loaderShow, loaderHide } from './js/loader';\n\nimport fetchImage, { paginationConfig } from './js/pixabay-api';\nimport { btnMoreHide, isbtnMoreHidden, showLoadMore } from './js/btn-show-more';\n\nconst searchForm = document.querySelector('form');\nconst loadMore = document.querySelector('.load-more');\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  const searchValue = event.target.search.value.trim();\n  if (!searchValue)\n    return iziToast.warning({\n      position: 'topRight',\n      message: 'Please fill-in the search input',\n    });\n\n  event.target.reset();\n\n  btnMoreHide();\n  resetGalelry();\n  loaderShow();\n  fetchAndRender(searchValue);\n});\n\nloadMore.addEventListener('click', async event => {\n  await fetchAndRender();\n\n  scrollDown();\n  if (isbtnMoreHidden())\n    iziToast.success({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n});\n\nasync function fetchAndRender(searchValue) {\n  try {\n    const data = await fetchImage(searchValue);\n    if (data.totalHits === 0)\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    renderGallery(data.hits);\n  } catch (error) {\n    iziToast.warning({\n      position: 'topRight',\n      message: error.message,\n    });\n  }\n\n  loaderHide();\n  showLoadMore(paginationConfig);\n}\n\nfunction scrollDown() {\n  const { height } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n  window.scrollBy({ top: height, behavior: 'smooth' });\n}\n"],"names":["gallery","lightBox","SimpleLightbox","renderGallery","hits","markup","item","resetGalelry","loader","loaderShow","loaderHide","key","baseURL","instance","axios","paginationConfig","fetchImage","query","searchParams","response","loadMore","showLoadMore","page","total","per_page","btnMoreShow","btnMoreHide","isbtnMoreHidden","searchForm","event","searchValue","iziToast","fetchAndRender","scrollDown","data","error","height"],"mappings":"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"}